<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" integrity="sha384-Zug+QiDoJOrZ5t4lssLdxGhVrurbmBWopoEl+M6BdEfwnCJZtKxi1KgxUyJq13dy" crossorigin="anonymous">
    <link rel="stylesheet" href="./stylesheets/main.css">
    <link href="https://fonts.googleapis.com/css?family=Share+Tech+Mono" rel="stylesheet">
    <title>BitMiner Online</title>
  </head>
  <body>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/js/bootstrap.min.js" integrity="sha384-a5N7Y/aK3qNeh15eJKGWxsqtnX/wWdSZSKp+81YjTmS15nvnvxKHuzaWwXHDli+4" crossorigin="anonymous"></script>
    
    <div class="container main">
        <div class="container" id="hud">
           <div class="row">
                   <div class="col-4 hudItem">
                       <p id="moneyLabel">$ <span id="moneyAmt">0</span></p>
                   </div>
                   <div class="col bitCoin">
                       <img id="bitCoinIco" class="img-fluid" src="./imgs/Bitcoin.png">
                   </div>
                   <div class="col-4 hudItem">
                       <p id="bitCoins"><span id="bitCoinAmt">0</span></p>
                   </div>
                   <div class="col">
                       <a data-toggle="modal" data-target="#menuWindow" class="hudBtn" id="minerUpgradeBtn">Menu</a>
                   </div>    
           </div>
        </div>
                        <div class="modal fade" id="menuWindow" tabindex="-1" role="dialog" aria-labelledby="menu window" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="upgradeWindowTitle">Menu</h5>
      </div>
      <div class="modal-body">
        <div class="container menuContainer">
            <div class="row">
               <div class="col">
                   <button type="button" data-toggle="modal" data-target="#minerUpgradeWindow" class="btn hudBtn" id="">Miner Upgrades</button>
               </div>
               <div class="col">
                   <button type="button" data-toggle="modal" data-target="#systemUpgradeWindow" class="btn hudBtn" id="">System Upgrades</button>
               </div>
            </div>
        </div>
      </div>
      <div class="modal-footer">
      </div>
    </div>
  </div>
</div> <!--end menu modal-->

            <div class="modal fade" id="minerUpgradeWindow" tabindex="-1" role="dialog" aria-labelledby="upgradeWindow" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="upgradeWindowTitle">Miner Upgrades</h5>
      </div>
      <div class="modal-body">
        <div class="container">
            <div class="row upgradeRow">
               <div class="col upgradeItem">
                    <img src="./imgs/caffeine.png" class="upgradeImg"> 
               </div>
                <div class="col-6 upgradeDesc upgradeItem">
                    <p class="upgradeDesc ">Your miner chugs caffeine like his life depends on it and pecks at the keyboard so fast the keys may fly off! (This upgrade will increase your passive money rate).</p>
                </div>
                <div class="col upgradeItem">
                    <button type="button" class="btn hudBtn upgBtn" id="caffeine">
                        $1,000
                    </button>
                </div>
            </div><!--end upgrade item-->
            <div class="row upgradeRow">
               <div class="col upgradeItem">
                    <img src="./imgs/pills.png" class="upgradeImg "> 
               </div>
                <div class="col-6 upgradeDesc upgradeItem">
                    <p class="upgradeDesc ">Fueled by Mexican black market "focus supplements", your miner stays awake for periods of days as he furiously hacks away on the cracking plastic keys of his weapon of mass destruction.</p>
                </div>
                <div class="col upgradeItem">
                    <button type="button" class="btn hudBtn upgBtn" id="pills">
                        $5,000
                    </button>
                </div>
            </div><!--end upgrade item-->
        </div>
      </div>
      <div class="modal-footer">
      </div>
    </div>
  </div>
</div> <!--end miner upgrades modal-->
        <div class="modal fade" id="systemUpgradeWindow" tabindex="-1" role="dialog" aria-labelledby="systemUpgradeWindow" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="upgradeWindowTitle">System Upgrades</h5>
      </div>
      <div class="modal-body">
        <div class="container">
            <div class="row upgradeRow">
               <div class="col upgradeItem">
                    <img id="ramImg" src="./imgs/ram.png" class="upgradeImg"> 
               </div>
                <div class="col-5 upgradeDesc upgradeItem">
                    <p class="upgradeDesc">Stuff your clunker of a system full of RAM and boost your Bitcoin mining speed. Maybe one day you will be able to afford a proper system.</p>
                </div>
                <div class="col upgradeItem">
                    <button type="button" class="btn hudBtn upgBtn sysUpg" id="ram">
                        $10,000
                    </button>
                </div>
            </div>
        </div>
      </div>
      <div class="modal-footer">
      </div>
    </div>
  </div>
</div> <!--end system upgrades modal-->

        <div class="container miner">
            <div id="minerContainer" class="minerClick">
                <img class="img-fluid" src="./imgs/miner.png">
            </div>
        </div>
    </div>
    <script type="text/javascript" src="./scripts/game.js"></script>
    <script type="text/javascript">
        //init();
        var myUser = new User("asshole");
        var system = new System();
        var moneyHud = document.querySelector("#moneyAmt");
        var bitCoinAmt = document.querySelector("#bitCoinAmt");
        var gameArea = document.querySelector(".miner");
        var minerImg = document.querySelector("#minerContainer");
        var upgBtns = document.querySelectorAll(".upgBtn");
        
        upgBtns.forEach(function(btn){
            if(btn.classList.contains("sysUpg")){
                btn.addEventListener("click",function(){
                    console.log("This is a sys upgrade");
                    var gotUpg = system.updateUpg(myUser,btn.id);
                    if(gotUpg){
                        btn.disabled = true;
                        console.log("Disabled");
                        btn.textContent = "Owned";
                    }
                }); 
            }else{
                btn.addEventListener("click",function(){
                    console.log("Not sys upg");
                    var gotUpg = myUser.updateUpg(btn.id);
                    if(gotUpg){
                        btn.disabled = true;
                        console.log("Disabled");
                        btn.textContent = "Owned";
                    }
                }); 
            }
           
        });
        
        minerImg.addEventListener("click",function(){
            myUser.work();
            updateHud();
        });
        
        var upgrades = myUser.getUpgrades();
 
        function updateHud(){
            moneyHud.innerHTML = myUser.getMoney();
            bitCoinAmt.innerHTML= myUser.getBitCoins();
        }
        
        setInterval(function(){
            myUser.mine(system.getTimeToCoin());
            updateHud();
        },100);
        
        setInterval(function(){
           myUser.work();
            updateHud();
        },200);
      </script>
  </body>
</html>